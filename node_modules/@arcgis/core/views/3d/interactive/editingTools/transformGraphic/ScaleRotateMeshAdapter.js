/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
import{_ as e}from"../../../../../chunks/tslib.es6.js";import{HandleOwner as t}from"../../../../../core/HandleOwner.js";import{deg2rad as s,rad2deg as i}from"../../../../../core/mathUtils.js";import{isSome as o}from"../../../../../core/maybe.js";import{react as r,sync as a}from"../../../../../core/reactiveUtils.js";import{property as c}from"../../../../../core/accessorSupport/decorators/property.js";import"../../../../../core/arrayUtils.js";import"../../../../../core/has.js";import"../../../../../core/accessorSupport/ensureType.js";import{subclass as n}from"../../../../../core/accessorSupport/decorators/subclass.js";import{axis as p,angle as h}from"../../../../../geometry/support/axisAngleDegrees.js";import{createGraphicGeometryUndoRecord as l}from"./undoRecords.js";let g=class extends t{constructor(e){super(e),this.angle=0,this.scale=1,this.initialAngle=0,this.previousAngle=0,this.previousScale=1}initialize(){this.restart()}restart(){this.handles.remove(m);const e=this.geometry.transform;if(this.scale=1,o(e)){const t=p(e.rotation)[2];Math.abs(t)>.999999&&(this.angle=s(h(e.rotation))*Math.sign(t))}this.initialAngle=this.angle,this.previousAngle=this.angle,this.previousScale=this.scale,this.handles.add(r((()=>({angle:this.angle,scale:this.scale})),(e=>this.update(e)),a),m)}cancel(){this.scale=1,this.angle=this.initialAngle}createUndoRecord(){return l(this.graphic)}update({scale:e,angle:t}){const s=this.geometry.anchor,o=1===this.viewingMode;e!==this.previousScale&&(this.geometry.scale(e/this.previousScale,{origin:s,geographic:o}),this.previousScale=e,this.graphic.notifyGeometryChanged()),t!==this.previousAngle&&(this.geometry.rotate(0,0,i(t-this.previousAngle),{origin:s,geographic:o}),this.previousAngle=t,this.graphic.notifyGeometryChanged())}};e([c({constructOnly:!0})],g.prototype,"graphic",void 0),e([c({constructOnly:!0})],g.prototype,"geometry",void 0),e([c({constructOnly:!0})],g.prototype,"viewingMode",void 0),e([c()],g.prototype,"angle",void 0),e([c()],g.prototype,"scale",void 0),g=e([n("esri.views.3d.interactive.editingTools.transformGraphic.ScaleRotateMeshAdapter")],g);const m="scale-heading-update-key";export{g as ScaleRotateMeshAdapter};
