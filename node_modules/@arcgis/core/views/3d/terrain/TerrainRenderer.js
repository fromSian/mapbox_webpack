/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
import{_ as e}from"../../../chunks/tslib.es6.js";import t from"../../../Color.js";import i from"../../../core/Accessor.js";import{isSome as r,isNone as s}from"../../../core/maybe.js";import n from"../../../core/ObjectPool.js";import a from"../../../core/PooledArray.js";import{property as o}from"../../../core/accessorSupport/decorators/property.js";import"../../../core/arrayUtils.js";import"../../../core/has.js";import"../../../core/accessorSupport/ensureType.js";import{subclass as l}from"../../../core/accessorSupport/decorators/subclass.js";import{a as d}from"../../../chunks/mat4.js";import{c as h,I as c}from"../../../chunks/mat4f64.js";import{f as u,s as p,n as g,d as f}from"../../../chunks/vec3.js";import{Z as m,c as T}from"../../../chunks/vec3f64.js";import{s as v}from"../../../chunks/vec4.js";import{Z as b,c as y}from"../../../chunks/vec4f64.js";import{create as x,set as R,expandWithOffset as _}from"../../../geometry/support/aaBoundingBox.js";import{BufferViewVec3f as O}from"../../../geometry/support/buffer/BufferView.js";import{requestImage as k}from"../../../support/requestImageUtils.js";import{overlayRenderOccludedFlag as q}from"./OverlayRenderer.js";import{clearCaches as D,getGlobalSkirtGeometry as C,intersectSkirtsGlobal as S,intersectSkirtsLocal as P}from"./PatchGeometryFactory.js";import{PatchRenderData as w}from"./PatchRenderData.js";import{ScaleRangeQueries as B}from"./ScaleRangeQueries.js";import{DEFAULT_TILE_BACKGROUND as j}from"./TerrainConst.js";import{TileRenderer as U}from"./TileRenderer.js";import{IteratorPreorder as E,sortTiles as G,compareTiles as M}from"./tileUtils.js";import{componentMinimalSizeForIntersectionData as N,ComponentIntersectionData as A}from"../webgl-engine/collections/Component/ComponentIntersectionData.js";import{bindSliceUniforms as I}from"../webgl-engine/core/shaderLibrary/Slice.glsl.js";import{bindSSRUniforms as F}from"../webgl-engine/core/shaderLibrary/shading/ScreenSpaceReflections.glsl.js";import{bindProjectionMatrix as L}from"../webgl-engine/core/shaderLibrary/util/View.glsl.js";import{createEmptyTexture as z}from"../webgl-engine/lib/glUtil3D.js";import{newIntersectorResult as V}from"../webgl-engine/lib/Intersector.js";import{getSettings as H}from"../webgl-engine/lib/screenSizePerspectiveUtils.js";import{TERRAIN_ID as Q,getVerticalOffsetTerrain as W}from"../webgl-engine/lib/verticalOffsetUtils.js";import{bindScreenSizePerspective as Y,intersectAabbInvDirBefore as Z,intersectTriangles as J}from"../webgl-engine/materials/internal/MaterialUtil.js";import{TerrainTechniqueConfiguration as K,TerrainTechnique as X}from"../webgl-engine/shaders/TerrainTechnique.js";const $=7,ee=10,te=x(),ie=y();let re=class extends i{constructor(e){super(e),this.type=2,this.isGround=!0,this.tileSize=256,this.rctx=null,this._isTransparent=!1,this._scaleRangeQueries=new B,this.renderDataPool=new n(w),this._patchGroups=new a({allocator:e=>e||{root:null,origin:null,patches:new a},deallocator:e=>(e.root=null,e.origin=null,e.patches.clear(),e)}),this.patchGroupsDirty=!0,this.patchGroupsMap=new Map,this.tileIterator=new E,this.highestVisibleLODTile=null,this.visible=!0,this._opaque=!0,this._skirtScale=1,this._velvetOverground=!0,this.castShadows=!0,this._ssrEnabled=!1,this.emptyTex=null,this.tileRenderer=null,this.tileBackgroundInitialized=!1,this.tileBackgroundUpdating=!1,this.stencilEnabledLayerExtents=[],this.numTrianglesRendered=0,this.numTilesRendered=0,this.numTilesCulled=0,this.numOriginsRendered=0,this.overlayOpacity=1,this.needsHighlight=!1,this.renderOccludedFlags=1}get isGlobal(){return 1===this.stage.viewingMode}initialize(){const e=[1,6,8];this.stage.addRenderPlugin(e,this)}destroy(){this.stage.removeRenderPlugin(this),D()}get updating(){return!this.tileBackgroundInitialized||this.tileBackgroundUpdating}get canRender(){return this.visible&&!!this._rootTiles&&this.tileBackgroundInitialized&&!this.renderingDisabled}set renderingDisabled(e){this._set("renderingDisabled",!!e),this.setNeedsRender()}set opaque(e){this._opaque!==e&&(this._opaque=e,this.setNeedsRender())}get needsLinearDepth(){return this.overlayRenderer.hasWater}get opaque(){return this._opaque&&!this.shaderTechniqueConfig.slicePlaneEnabled}set isTransparent(e){this._isTransparent!==e&&(this._isTransparent=e,this.setNeedsRender())}get isTransparent(){return this._isTransparent}set skirtScale(e){e!==this._skirtScale&&(this._skirtScale=e,this.setNeedsRender())}get skirtScale(){return this._skirtScale}get renderPatchBorders(){return!!this.shaderTechniqueConfig.tileBorders}set renderPatchBorders(e){this.shaderTechniqueConfig.tileBorders!==e&&(this.shaderTechniqueConfig.tileBorders=e,this.setNeedsRender(),this.notifyChange("renderPatchBorders"))}get cullBackFaces(){return this.shaderTechniqueConfig.backfaceCullingEnabled}set cullBackFaces(e){this.shaderTechniqueConfig.backfaceCullingEnabled!==e&&(this.shaderTechniqueConfig.backfaceCullingEnabled=e,this.notifyChange("cullBackFaces"),this.setNeedsRender())}set renderOrder(e){this._set("renderOrder",e),this.setNeedsRender()}set velvetOverground(e){this._velvetOverground!==e&&(this._velvetOverground=e,this.setNeedsRender())}get layerUid(){return Q}get slicePlaneEnabled(){return this.shaderTechniqueConfig.slicePlaneEnabled}set slicePlaneEnabled(e){this.shaderTechniqueConfig.slicePlaneEnabled!==e&&(this.shaderTechniqueConfig.slicePlaneEnabled=e,this.setNeedsRender())}set textureFadingEnabled(e){this.shaderTechniqueConfig.textureFadingEnabled!==e&&(this.shaderTechniqueConfig.textureFadingEnabled=e,this.setNeedsRender())}setDebugScreenSizePerspective(e){this.shaderTechniqueConfig.screenSizePerspective!==e&&(this.shaderTechniqueConfig.screenSizePerspective=e,this.setNeedsRender())}setRootTiles(e){this._rootTiles=e,this.setNeedsRender()}setNeedsHighlight(e){this.needsHighlight=e,this.setNeedsRender()}setRenderOccludedOverlay(e){this.renderOccludedFlags=e?q:1,this.setNeedsRender()}setStencilEnabledLayerExtents(e){this.stencilEnabledLayerExtents=e,this.setNeedsRender()}setTileSize(e){this.tileSize=e,this.tileRenderer&&(this.tileRenderer.tileSize=e),this.setNeedsRender()}loadTile(e){e.renderData||(e.renderData=this.renderDataPool.acquire(),e.renderData.init(e),e.renderData.localOrigin=this._getLocalOriginOfTile(e)),this.updateTileGeometry(e),this.updateTileTexture(e,128)}queryVisibleLevelRange(e,t,i,r){this._scaleRangeQueries.queryVisibleLevelRange(e,t,i,r),this.setNeedsRender()}updateTileTexture(e,t){this.tileRenderer&&this.tileBackgroundInitialized&&(this.tileRenderer.updateTileTexture(e,128===t?0:2),this.setNeedsRender(),e.resetPendingUpdate(t))}updateTileGeometry(e){for(const t of e.layerInfo[0])t.pendingUpdates&=-33;e.resetPendingUpdate(32),e.renderData.updateGeometry(this.rctx,this.wireframe)&&this.setNeedsRender()}unloadTile(e){e.renderData&&(e.renderData.releaseGeometry()&&this.setNeedsRender(),this.renderDataPool.release(e.renderData),e.renderData.clear(),e.renderData=null,e.setMemoryDirty(),this.setNeedsRender())}_getLocalOriginOfTile(e){const t=ee-$,i=Math.max(0,Math.floor((e.level-t)/$)*$);if(this.isGlobal&&0===i)return m;for(;e.parent&&e.level>i;)e=e.parent;return e.centerAtSeaLevel}setVisibility(e){this.visible=e,this.setNeedsRender()}getStats(){return{numTilesRendered:this.numTilesRendered,numTilesCulled:this.numTilesCulled,numTrianglesRendered:this.numTrianglesRendered,numOriginsRendered:this.numOriginsRendered}}set wireframe(e){this._get("wireframe")!==e&&(this._set("wireframe",e),this.allTiles.forAll((t=>{var i;return null==(i=t.renderData)?void 0:i.updateGeometry(this.rctx,e)})),this.setNeedsRender())}setNeedsRender(e=1){this.patchGroupsDirty=!0,this.context.requestRender(e)}setTileBackground(e){this.tileBackground=e,this._updateTileBackground()}initializeRenderContext(e){this.context=e,this.rctx=e.renderContext.rctx,this.shaderTechniques=e.shaderTechniqueRep,this.shaderTechniqueConfig=new K,this.tileRenderer=new U(this.rctx,this.tileSize,this.shaderTechniques),this.tileBackground&&this._updateTileBackground(),this.emptyTex=z(this.rctx)}uninitializeRenderContext(){null!=this.emptyTex&&(this.emptyTex.dispose(),this.emptyTex=null),this.tileRenderer&&(this.tileRenderer.dispose(),this.tileRenderer=null)}intersect(e,t,i,n){if(!this._rootTiles||e.options.selectOpaqueTerrainOnly&&e.options.selectionMode&&!this._opaque)return;const a=de,o=he;u(a,n,i),p(o,1/a[0],1/a[1],1/a[2]);const l=e.results.min,d=e.results.max,h=e.results.ground,g=0===e.options.store,m=!!e.results.ground.target,T=W(e.verticalOffset),v=this._skirtScale,b=e.tolerance;let y,x=g&&r(l.dist)?l.dist:1/0;const k=p=>{const m=p.renderData;if(null==m)return;const k=m.geometryInfo;R(te,k.boundingBox);const q=m.localOrigin;r(T)&&(T.localOrigin=q,T.applyToAabb(te));const D=-v*k.skirtLength;if(0!==D){const e=p.up;_(te,D*e[0],D*e[1],D*e[2])}const w=te;if(ce[0]=i[0]-q[0],ce[1]=i[1]-q[1],ce[2]=i[2]-q[2],!Z(w,ce,o,b,x))return;const B=(e,t,i)=>{e.set(this.type,p,t,i,c),x=g&&r(l.dist)?l.dist:1/0},j=(o,c)=>{if(r(c)&&o>=0&&(e.options.backfacesTerrain||f(c,a)<0)&&(e.options.invisibleTerrain||!e.options.selectionMode||null==t||t(i,n,o))){if((null==h.dist||o<h.dist)&&B(h,o,c),e.options.isFiltered)return;2===e.options.store&&(s(y)?(y=V(e.ray),B(y,o,c),e.results.all.push(y)):o<y.dist&&B(y,o,c)),(null==l.dist||o<l.dist)&&B(l,o,c),0!==e.options.store&&(null==d.dist||o>d.dist)&&B(d,o,c)}},U=ue;u(U,n,q);const E=k.indices,G=k.vertexAttributes,M={data:G.getField("position",O).typedBuffer,size:3,stride:G.stride/4},I=k.numWithoutSkirtIndices/3;if(!r(T)&&I>N){const e=p.renderData;r(e.intersectionData)||(e.intersectionData=new A(E,0,I,M)),e.intersectionData.intersectRay({r0:ce,r1:U},j)}else J(ce,U,0,I,E,M,null,T,j);if(0!==D){const e=E.length/3;if(this.isGlobal){const t=e-I;if(!r(T)&&t>N){const i=p.renderData;if(!r(i.skirtIntersectionData)){const r=C(E,I,e,G,D,q);i.skirtIntersectionData=new A(r.indices,0,t,{data:r.vertices,stride:3})}i.skirtIntersectionData.intersectRay({r0:ce,r1:U},j)}else S(ce,U,I,e,E,G,D,q,T,j)}else P(ce,U,I,e,E,G,D,T,j)}},q=this._rootTiles;if(r(q)){(()=>{const t=this.tileIterator;t.reset(q);const s=e.options.invisibleTerrain;for(;!t.done;){const e=t.next();!(e.visible||s&&e.intersectsClippingArea)||!r(T)&&!e.intersectsRay(i,a,b,x,v)||m&&this._useStencilForTile(e)?t.skipSubtree():k(e)}})()}}render(e){if(8===e.slot){if(0==(e.renderOccludedMask&q))return!1}else{const t=this.opaque?1:6;if(e.slot!==t)return!1}const t=e.pass,i=1===e.scenelightingData.globalFactor,r=this._updatePatchGroups();let s=!1;switch(t){case 0:{const t=e.shadowMap&&e.shadowMap.enabled;this.shaderTechniqueConfig.receiveShadows!==t&&(this.shaderTechniqueConfig.receiveShadows=t);const i=this.overlayRenderer.isEmpty()?0:this.overlayRenderer.hasWater?2:1;this.shaderTechniqueConfig.overlayMode!==i&&(this.shaderTechniqueConfig.overlayMode=i);const n=8===e.slot?3:1;this._renderMaterialPass(e,0,r,n),s=!0;break}case 4:case 6:this.castShadows&&i&&(this._renderAuxiliaryPass(e,3,r,0),s=!0);break;case 2:this.isTransparent&&this.overlayRenderer.isEmpty()||(this._renderAuxiliaryPass(e,1,r,0),s=!0);break;case 3:this._renderAuxiliaryPass(e,2,r,0),s=!0;break;case 5:this.needsHighlight&&(this._renderAuxiliaryPass(e,4,r,2),e.rctx.clearSafe(256),s=!0)}return this._scaleRangeQueries.hasPendingQueries()&&this.setNeedsRender(),s}_renderMaterialPass(e,t,i,r){const{rctx:s,camera:n}=e;this._ssrEnabled=e.ssrParams.ssrEnabled,this._setTerrainTechnique(t,3===r);const a=this._shaderTechnique.program;s.useProgram(a),0!==this.shaderTechniqueConfig.overlayMode&&1===r&&e.ssrParams&&F(a,e.ssrParams),e.shadowMap.bind(a),e.ssaoHelper.bind(a,e.camera),this._bindOverlayData(a,r),a.setUniformMatrix4fv("viewNormal",n.viewInverseTransposeMatrix),L(a,n.projectionMatrix),e.scenelightingData.setUniforms(a,!0);const o=n.viewMatrix;p(le,o[12],o[13],o[14]),g(le,le),a.setUniform3fv("viewDirection",le),this.numTilesRendered=0,this.numTilesCulled=0,this.numTrianglesRendered=0,this.numOriginsRendered=0,this._scaleRangeQueries.prepareQueries(),this.opaque?this._renderPatchGroups(e,a,i,r):e.offscreenRenderingHelper.renderToTargets((()=>this._renderPatchGroups(e,a,i,r)),e.offscreenRenderingHelper.tmpColor,e.offscreenRenderingHelper.mainDepth,[0,0,0,0]),this._scaleRangeQueries.processQueries()}_renderAuxiliaryPass(e,t,i,r){this._setTerrainTechnique(t,3===r);const s=e.rctx,n=this._shaderTechnique.program;if(s.useProgram(n),5===e.pass){const t=e.offscreenRenderingHelper;n.bindTexture(t.depthTexture,"depthTex"),n.setUniform4f("highlightViewportPixelSz",0,0,1/t.width,1/t.height)}else n.setUniformMatrix4fv("viewNormal",e.camera.viewInverseTransposeMatrix),2!==e.pass&&4!==e.pass&&6!==e.pass||n.setUniform2fv("nearFar",e.camera.nearFar);this._renderPatchGroupsAuxiliary(e,n,i,r)}_updateTileBackground(){if(!this.tileRenderer)return;this.tileBackgroundUpdating=!0;const e=()=>{this.tileBackgroundInitialized=!0,this.tileBackgroundUpdating=!1,this.shaderTechniqueConfig.useGrid=this.tileRenderer.backgroundIsGrid,this.shaderTechniqueConfig.hasBackgroundColor=!this.tileRenderer.backgroundIsGrid&&!!r(this.tileRenderer.backgroundColor),this.allTiles.forAll((e=>this.tileRenderer.updateTileTexture(e,0))),this.setNeedsRender()};if("string"==typeof this.tileBackground){const t=this.tileBackground;k(t).then((i=>{t===this.tileBackground&&this.tileRenderer&&(this.tileRenderer.setBackground(i,this.tileBackground===j),e())}))}else{const i=this.tileBackground?t.toUnitRGBA(this.tileBackground):[0,0,0,0];this.tileRenderer.setBackground(i,!1),e()}}_updatePatchGroups(){const e=this._patchGroups;if(!this.patchGroupsDirty)return e;if(this.highestVisibleLODTile=null,this._renderCollectOrigins(e),0!==this.renderOrder){for(let t=0;t<e.length;t++)G(this.renderOrder,e.data[t].patches);e.sort(((e,t)=>ne(e,t,this.renderOrder)))}return this.patchGroupsDirty=!1,e}_renderCollectOrigins(e){const t=this._rootTiles;if(s(t))return;const i=this.isGlobal;e.clear();for(const r of t){const t=e.pushNew();t.root=r,t.origin=i?m:r.centerAtSeaLevel,t.patches.clear(),this._renderCollectOriginsForRoot(e,t)}e.filterInPlace((e=>e.patches.length>0))}_renderCollectOriginsForRoot(e,t){const i=this.tileIterator;i.resetOne(t.root);const r=this.patchGroupsMap;for(r.clear(),r.set(t.origin,t);!i.done;){const t=i.next(),s=t.renderData;if(!s||t.visible){if(t.level%$==0){const i=e.pushNew();i.root=t,i.origin=t.centerAtSeaLevel,r.set(t.centerAtSeaLevel,i),i.patches.clear()}if(t.rendered){if(s){const e=r.get(s.localOrigin);e&&e.patches.push(t),(!this.highestVisibleLODTile||t.vlevel>this.highestVisibleLODTile.vlevel)&&(this.highestVisibleLODTile=t),i.skipSubtree()}}else this.numTilesCulled++}else this.numTilesCulled++,i.skipSubtree()}}_useStencilForTile(e){for(const t of this.stencilEnabledLayerExtents)if(e.intersectsExtent(t))return!0;return!1}_renderPatchGroupsAuxiliary(e,t,i,r){const s=e.rctx;this._shaderTechnique.useStencil=!1,this._shaderTechnique.bindPipelineState(s,e.slot);const n=this.stencilEnabledLayerExtents.length>0;t.setUniformMatrix4fv("proj",e.camera.projectionMatrix),t.setUniform1f("skirtScale",this._skirtScale),0!==r&&this._bindOverlayData(t,r);for(let a=0;a<i.length;a++){const s=i.data[a];this._bindPatchGroupData(t,s,e.camera.eye,e.camera.viewMatrix);for(let i=0;i<s.patches.length;i++)this._renderPatch(e,t,s.patches.data[i],4,n,r)}e.rctx.bindVAO(null)}_renderPatchGroups(e,t,i,n){const a=e.rctx,o=e.camera,l=o.viewMatrix;if(this._shaderTechnique.useStencil=!1,this._shaderTechnique.bindPipelineState(a,e.slot),this.shaderTechniqueConfig.screenSizePerspective&&this.pointsOfInterest){const e=H(this.stage.viewingMode,this.ellipsoidRadius),i=this.pointsOfInterest.centerOnSurfaceFrequent.distance;e.update({distance:i,fovY:o.fovY}),Y(e,t,"screenSizePerspective")}const d=this.stencilEnabledLayerExtents.length>0,h=3===n;h&&(t.bindTexture(this.emptyTex,"tex"),t.setUniform1f("blend",1),t.setUniform4fv("texOffsetAndScale",b));const c=r(this.tileRenderer.backgroundColor)?this.tileRenderer.backgroundColor:m;this.shaderTechniqueConfig.hasBackgroundColor&&t.setUniform3fv("backgroundColor",c);const u=h?0:this._skirtScale;t.setUniform1f("skirtScale",u);const p=this.wireframe?1:4;this.shaderTechniqueConfig.textureFadingEnabled&&t.bindTexture(this.emptyTex,"texNext");for(let g=0;g<i.length;g++){const a=i.data[g],c=a.patches;this._bindPatchGroupData(t,a,o.eye,l);const u=e.sliceHelper&&e.sliceHelper.plane;I(t,this._shaderTechnique.configuration,u,a.origin),e.shadowMap&&e.shadowMap.bindView(t,a.origin),this.numOriginsRendered++;for(let i=0;i<c.length;i++){const a=c.data[i],o=a.renderData.textureReference;if(s(o))continue;if(!h){this._scaleRangeQueries.scaleQueriesForTile(a),ae(a.renderData.geometryInfo.uvOffsetAndScale,o.offsetAndScale,ie),t.setUniform4fv("texOffsetAndScale",ie),t.bindTexture(o.texture.texture,"tex");const e=a.renderData.textureFadeFactor,i=e<1?a.renderData.nextTextureReference:null;this.shaderTechniqueConfig.textureFadingEnabled&&r(i)&&e<1?(ae(a.renderData.geometryInfo.uvOffsetAndScale,i.offsetAndScale,ie),t.setUniform1f("fadeFactor",e),t.setUniform4fv("nextTexOffsetAndScale",ie),t.setUniform3fv("nextTexOpacities",i.opacities),t.bindTexture(i.texture.texture,"texNext")):t.setUniform1f("fadeFactor",1),a.renderData.textureIsFading&&this.setNeedsRender(),t.setUniform3fv("textureOpacities",o.opacities)}const l=this._renderPatch(e,t,a,p,d,n);a.renderOrder=this.numTilesRendered,this.numTilesRendered++,this.numTrianglesRendered+=l/3}}a.bindVAO(null)}_renderPatch(e,t,i,r,n,a){if(s(i.renderData.vao.indexBuffer))return 0;0!==a&&this._bindOverlayPatchData(t,i.renderData.overlay),n&&(this._shaderTechnique.useStencil=this._useStencilForTile(i),this._shaderTechnique.bindPipelineState(e.rctx,e.slot));const o=0===this._skirtScale?i.renderData.geometryInfo.numWithoutSkirtIndices:i.renderData.vao.indexBuffer.size;return e.rctx.bindVAO(i.renderData.vao),t.assertCompatibleVertexAttributeLocations(i.renderData.vao),e.rctx.drawElements(r,o,i.renderData.vao.indexBuffer.indexType,0),o}_bindPatchGroupData(e,t,i,r){e.setUniform3fv("origin",t.origin),d(oe,r,t.origin),e.setUniformMatrix4fv("view",oe),e.setUniform3f("camPos",i[0]-t.origin[0],i[1]-t.origin[1],i[2]-t.origin[2])}_bindOverlayData(e,t){if(0===this.shaderTechniqueConfig.overlayMode)return;e.setUniform1f("overlayOpacity",this.overlayOpacity);const i=this.overlayRenderer.overlays;if(i.length>0){const s=i[0],n=s.getColorTexture(t);if(e.bindTexture(r(n)?n:this.emptyTex,"ovColorTex"),2===this.shaderTechniqueConfig.overlayMode){const i=s.getNormalTexture(t);e.bindTexture(r(i)?i:this.emptyTex,"ovWaterTex")}}}_bindOverlayPatchData(e,t){e.setUniform4fv("overlayTexOffset",t.offsets),e.setUniform4fv("overlayTexScale",t.scales)}_setTerrainTechnique(e,t){this.shaderTechniqueConfig.output=e,0===e&&(this.shaderTechniqueConfig.atmosphere=this.isGlobal&&this._velvetOverground,this.shaderTechniqueConfig.ssrEnabled=this._ssrEnabled),this.shaderTechniqueConfig.renderOccluded=t,this.shaderTechniqueConfig.stencilEnabled=!1,this._shaderTechnique=this.shaderTechniques.releaseAndAcquire(X,this.shaderTechniqueConfig,this._shaderTechnique)}get test(){return{tileRenderer:this.tileRenderer}}};e([o()],re.prototype,"tileBackgroundInitialized",void 0),e([o()],re.prototype,"tileBackgroundUpdating",void 0),e([o({constructOnly:!0})],re.prototype,"overlayRenderer",void 0),e([o({constructOnly:!0})],re.prototype,"stage",void 0),e([o({readOnly:!0})],re.prototype,"isGlobal",null),e([o({constructOnly:!0})],re.prototype,"allTiles",void 0),e([o({constructOnly:!0})],re.prototype,"ellipsoidRadius",void 0),e([o({readOnly:!0})],re.prototype,"updating",null),e([o({value:!1})],re.prototype,"renderingDisabled",null),e([o()],re.prototype,"renderPatchBorders",null),e([o()],re.prototype,"cullBackFaces",null),e([o({value:1})],re.prototype,"renderOrder",null),e([o()],re.prototype,"wireframe",null),re=e([l("esri.views.3d.terrain.TerrainRenderer")],re);const se=re;function ne(e,t,i){return 0===e.patches.length?-i:0===t.patches.length?i:M(e.patches.data[0],t.patches.data[0],i)}function ae(e,t,i){const r=e[0]*t[2]+t[0],s=e[1]*t[3]+t[1],n=e[2]*t[2],a=e[3]*t[3];v(i,r,s,n,a)}const oe=h(),le=T(),de=T(),he=T(),ce=T(),ue=T();export{se as default};
