/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
import{isSome as e}from"../../../../core/maybe.js";import t from"../../../../core/PerformanceSampler.js";import{once as r}from"../../../../core/accessorSupport/utils.js";import{startMeasurement as s}from"../../../webgl/Measurement.js";const i=["prepare","shadowmap","lineardepth","normals","ssao","opaque","opaque edges","transparent","transparent edges","hudvisibility","transparent terrain","atmosphere","laserline","occluded","antialiasing","highlights","hudOccluded","hudNotoccluded"];class a extends t{constructor(){super("total"),this.total=0,this.frameCount=0}}class o{constructor(){this._startTime=0,this._lastSample=0,this._enableGPUTimer=0,this.totalTime=new a,this.gpuTime=new t("gpu",9),this.renderPassTimings=i.map((e=>new t(e)))}enableGPUTimer(){return++this._enableGPUTimer,{remove:r((()=>--this._enableGPUTimer))}}prerender(e){this._startTime=this._lastSample=performance.now(),this._enableGPUTimer&&(this._gpuTimer=s(e))}advance(e){const t=performance.now();this.renderPassTimings[e].record(t-this._lastSample),this._lastSample=t}postrender(){e(this._gpuTimer)&&(this._gpuTimer.stop((t=>e(t)&&this.gpuTime.record(t)),16),this._gpuTimer=null);const t=performance.now()-this._startTime;this.totalTime.record(t),this.totalTime.total+=t,this.totalTime.frameCount++}}export{a as RenderTime,o as RendererPerformanceInfo,i as performanceStatsCategories};
