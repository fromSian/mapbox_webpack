/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
import{bidiText as e}from"../../../core/BidiText.js";import{pt2px as t}from"../../../core/screenUtils.js";import{getXAnchorDirection as i,getYAnchorDirection as n}from"../engine/webgl/alignmentUtils.js";import{MAGIC_LABEL_LINE_HEIGHT as o,GLYPH_SIZE as l}from"../engine/webgl/definitions.js";import{shapeGlyphs as a}from"../engine/webgl/mesh/templates/shapingUtils.js";async function s(s,r,m){var f,g,h;const c=i("center"),d=n("middle"),x=r.textureManager.rasterizeItem(s.toJSON(),window.devicePixelRatio||1,null,m),[,p]=e(s.text),u=(await x).glyphMosaicItems;return a(u,p,{angle:null!=(f=s.angle)?f:0,xOffset:t(null!=(g=s.xoffset)?g:0),yOffset:t(null!=(h=s.yoffset)?h:0),lineHeight:o*Math.max(.25,Math.min(s.lineHeight,4)),maxLineWidth:Math.max(32,Math.min(t(s.lineWidth),512)),decoration:s.font.decoration,scale:Math.min(Math.round(t(s.font.size)),127)/l,hAlign:c,vAlign:d,isCIM:!1}).boundsT}export{s as getTextBounds};
